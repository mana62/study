# イベントとリスナー
→ 何かが起きたときに、自動で別の処理を流す仕組み

---

## イベントとリスナーとは
- **イベント：** 何かが「起きた！」という合図（例：ユーザーが登録された）
- **リスナー：** その合図を「聞いて」、何かをする人（例：メールを送る）

---

## どんな時に使うのか

| シーン         | イベント             | リスナーの役割                          |
|----------------|----------------------|-----------------------------------------|
| ユーザー登録   | `UserRegistered`     | ウェルカムメールを送る                  |
| 商品購入       | `OrderPlaced`        | 在庫を減らす、領収書を送る              |
| パスワード変更 | `PasswordChanged`    | セキュリティ通知を送る                  |
| コメント投稿   | `CommentPosted`      | 通知を送る、ログを記録する              |

---

## 使い方の流れ
- ① ベントクラスを作る

```bash
php artisan make:event UserRegistered
```

- ②リスナークラスを作る

```bash
php artisan make:listener SendWelcomeEmail --event=UserRegistered
```

- ③イベントを発火する（例えばユーザー登録時に）

```php
event(new UserRegistered($user));
```
→ すると、SendWelcomeEmail が自動で呼ばれて、メールが送られる

---

## 使うメリット
- コードがスッキリする（コントローラーに全部書かなくていい）
- 処理の分離ができる（登録とメール送信を分けられる）
- 複数のリスナーを同じイベントにぶら下げられる（通知＋ログ＋分析など）

---

## Mailableとの違い
→ イベントとリスナーは「メール以外の処理も一緒に管理したいとき」に便利


| 項目       | Mailable                        | イベント＋リスナー                                 |
|------------|----------------------------------|----------------------------------------------------|
| 目的       | メールを送る                     | 何かが起きたときに複数の処理を実行                |
| 処理内容   | メール送信のみ                   | メール送信＋ログ記録＋通知など                    |
| 呼び出し方 | `Mail::to()->send()`            | `event(new イベント名)` で発火                     |
| 再利用性   | 単体で使う                       | 複数のリスナーで分割・再利用できる                |
