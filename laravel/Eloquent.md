## Eloquent

| 書き方                                              | 使いどころ                                                                                     | 例文                                                                                                                                              |
| --------------------------------------------------- | ---------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Post::all()`                                       | 全件取得。条件なしで一気に欲しいとき                                                           | `$posts = Post::all();`                                                                                                                           |
| `Post::where(...)`                                  | 条件が1つだけで確定してるとき                                                                  | `$posts = Post::where('status', 'published')->get();`                                                                                             |
| `Post::query()`                                     | 条件をあとから柔軟に追加したいとき（検索・絞り込み）関数の中の一番上に書く                     | `$query = Post::query(); if ($keyword) { $query->where('title', 'LIKE', "%{$keyword}%"); } $posts = $query->get();`                               |
| `Post::find($id)`                                   | 主キー（id）で1件だけ取得したいとき                                                            | `$post = Post::find(5);`                                                                                                                          |
| `Post::findOrFail($id)`                             | 主キーで取得し、見つからなければ404を返したいとき（REST設計でよく使う）                        | `$post = Post::findOrFail($id);`                                                                                                                  |
| `Post::first()`                                     | 最初の1件だけ欲しいとき（並び順が重要）                                                        | `$post = Post::first();`                                                                                                                          |
| `Post::firstWhere('status', 'published')`           | 条件付きで最初の1件だけ欲しいとき                                                              | `$post = Post::firstWhere('status', 'published');`                                                                                                |
| `Post::latest()->get()`                             | 新しい順に並べて全部取得したいとき（created_at 降順）                                          | `$posts = Post::latest()->get();`                                                                                                                 |
| `Post::orderBy('title')->get()`                     | 任意のカラムで並び替えたいとき                                                                 | `$posts = Post::orderBy('title')->get();`                                                                                                         |
| `Post::paginate(10)`                                | ページネーションで10件ずつ表示したいとき                                                       | `$posts = Post::paginate(10);`                                                                                                                    |
| `Post::with('comments')->get()`                     | リレーションを一緒に取得したいとき（N+1問題対策）                                              | `$posts = Post::with('comments')->get();`                                                                                                         |
| `Post::orderBy('sort_order')->orderBy('id')->get()` | 複数カラムで並び替えたいとき。左側のカラム優先でソートし、nullや同値の場合は右側のカラムで補完 | `$posts = Post::orderBy('sort_order')->orderBy('id')->get();` <br> **解説:** sort_orderで並べ、sort_orderが存在しない場合や同値の場合はid順に並ぶ |
