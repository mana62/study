# プロパティの種類

| 種類 | 何を持つ？ | 何ができる？ |
|------|------------|----------------|
| **データプロパティ** | 値（value） | 普通のプロパティ。値をそのまま保持する |
| **アクセサプロパティ** | getter / setter | 値を「計算して返す」or「代入時に処理する」 |


## ① データプロパティ（普通のプロパティ）
→ 最も一般的なプロパティ

```js
const obj = {
  name: "Hanako"
}
```
=これは データプロパティ
=内部的にはこんな descriptor を持っている :

```js
{
  value: "Hanako", // プロパティが保持している 実際の値
  writable: true, // 値を書き換えられるかどうか
  enumerable: true, // 列挙（表示）されるかどうか
  configurable: true // プロパティの設定を変更できるかどうか
}
```
✅ 特徴
- 値をそのまま保持する
- 読み書きが普通にできる
- 一般的なプロパティは全部これ

## ② アクセサプロパティ（getter / setter）
→ 値を直接持たず、関数で値を返したり、代入時に処理したりするプロパティ

```js
const obj = {
  first: "Mana",
  last: "Fukumoto",

  get fullName() {
    return this.first + " " + this.last
  },

  set fullName(value) {
    const [f, l] = value.split(" ")
    this.first = f
    this.last = l
  }
}
```

✅ 読み取り時（get）
```js
console.log(obj.fullName)
// → "Hanako Yamada"
```

✅ 書き込み時（set）
```js
obj.fullName = "Hanako Yamada"

console.log(obj.first) // Hanako
console.log(obj.last)  // Yamada
```
✅ アクセサプロパティの descriptor
```js
{
  get: function() {},
  set: function() {},
  enumerable: true, // 列挙（表示）されるかどうか
  configurable: true // プロパティの設定を変更できるかどうか
}
```
**value や writable は存在しないのがポイント**

## データプロパティ vs アクセサプロパティ

データプロパティ
-------------------------
key: "name"
value: "Hanako"
-------------------------

アクセサプロパティ
-------------------------
key: "fullName"
get: function() { ... }
set: function() { ... }
-------------------------

⚫︎どんな時に使う？
データプロパティ : 普通の値を保持したい時（ほぼ全部のプロパティがこれ）
アクセサプロパティ : 値を「計算して返したい」時

| 目的 | 使うプロパティ |
|------|----------------|
| **値をそのまま保持したい** | データプロパティ |
| **値を計算して返したい** | getter（アクセサ） |
| **値の変更をフックしたい** | setter（アクセサ） |
| **ライブラリ内部で監視したい** | getter/setter（アクセサ） |


## まとめ
- データプロパティ → 普通の値を持つプロパティ
- アクセサプロパティ → get/set で動作するプロパティ
- descriptor の構造が違う
- Vue2 の reactivity など、フレームワーク内部で超重要

## 値 + 3のプロパティを持つ
- value: 60
- writable: true, // 値を書き換えられるかどうか
- enumerable: true, // 列挙（表示）されるかどうか
- configurable: true // プロパティの設定を変更できるかどうか

上記を確認することができるのが、**getOwnPropertyDescriptor**

```js
// 例
Object.getOwnPropertyDescriptor(obj, "servingSize"); // servingSizeはオブジェクトの名前
```
```js
// 結果
{
  value: 60,
  writable: true,
  enumerable: true,
  configurable: true
}
```

上記を書き換えられるのが**defineProperty**

```js
// 例
Object.defineProperty(obj, "servingSize", {
  writable: false
});
```

```js
obj.servingSize = 30; // ← 無視される（エラー or 変わらない）
```

= getter / setter はこのプロパティディスクリプタの一種

## まとめ
- プロパティ = 値 + 裏の設定
- 裏の設定を見る → getOwnPropertyDescriptor
- 裏の設定を変える → defineProperty
- getter / setter はその延長線

---

**Object.defineProperty** を使うと、すでにあるオブジェクトに「後付け」で getter / setter を生やせる

---

| 分類     | メソッド                  |
| ------ | --------------------- |
| 拡張を止める | `preventExtensions`   |
| 封印する   | `seal` / `isSealed`   |
| 凍結する   | `freeze` / `isFrozen` |
| 状態確認   | `isExtensible`        |

① Object.preventExtensions(obj)
👉 新しいプロパティ追加だけ禁止
```js
obj.a = 1;   // OK
obj.b = 2;   // ❌
```

② Object.seal(obj)
👉 追加 ❌ / 削除 ❌ / 値の変更は ⭕

```js
obj.a = 2;        // OK
delete obj.a;    // ❌
obj.b = 3;       // ❌
```

③ Object.freeze(obj)
👉 完全ロック（追加・削除・変更すべて不可）

```js
obj.a = 2;     // ❌
delete obj.a; // ❌
obj.b = 3;    // ❌
```

④ 状態確認系
```js
Object.isExtensible(obj)
Object.isSealed(obj)
Object.isFrozen(obj)
```
👉 デバッグ・検査用

### 実際どこで使われてるのか
① ライブラリ・フレームワーク内部
- React
- Vue
- Redux
- Immer
- MobX
- 状態管理ライブラリ
👉 内部で使われている