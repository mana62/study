# ヘルパークラス・メソッド(laravel特有)

## ヘルパークラス・メソッド使う場面
# Laravelヘルパーの使用場面（Str / Arr）

# Laravelヘルパー（Str / Arr）の使用場面まとめ

| 使用場所             | よくある処理内容                     | 使用例                                    | 使用ヘルパー |
| -------------------- | ------------------------------------ | ----------------------------------------- | ------------ |
| コントローラー       | リクエストデータの整形・トークン生成 | `Str::slug($title)` / `Str::random(32)`   | Str          |
| モデル               | 保存前のデータ加工・関連抽出         | `Str::limit($description, 100)`           | Str          |
| テスト               | ダミーデータ生成・レスポンス検証     | `Str::contains($response, 'success')`     | Str          |
| ミドルウェア         | ヘッダーやURLの条件分岐              | `Str::contains($request->url(), 'admin')` | Str          |
| サービスクラス       | 共通処理の整形・再利用               | `Arr::pluck($users, 'email')`             | Arr          |
| ビュー（Blade）      | 表示用の文字列整形                   | `{{ Str::limit($post->body, 100) }}`      | Str          |
| シーダー             | 初期データの生成                     | `'slug' => Str::slug($faker->sentence)`   | Str          |
| バリデーション       | 入力形式のチェック                   | `Str::startsWith($value, 'user_')`        | Str          |
| Artisanコマンド      | CLI出力の整形・ログ表示              | `$this->info(Str::upper('done'))`         | Str          |
| イベントリスナー     | イベントデータの加工                 | `Arr::except($eventData, ['secret'])`     | Arr          |
| 通知（Notification） | メッセージの整形                     | `Str::limit($message, 50)`                | Str          |
| ジョブ（Queue）      | キュー処理中のデータ整形             | `Arr::has($payload, 'user_id')`           | Arr          |


## 文字列 Str
| No  | メソッド                                    | 説明                          | 例                                                                |
| --- | ------------------------------------------- | ----------------------------- | ----------------------------------------------------------------- |
| 1   | `Str::upper($str)`                          | 文字列をすべて大文字にする    | `Str::upper('hello') → 'HELLO'`                                   |
| 2   | `Str::lower($str)`                          | 文字列をすべて小文字にする    | `Str::lower('HELLO') → 'hello'`                                   |
| 3   | `Str::ucfirst($str)`                        | 先頭文字だけ大文字にする      | `Str::ucfirst('hello') → 'Hello'`                                 |
| 4   | `Str::title($str)`                          | 単語の先頭文字を大文字にする  | `Str::title('hello world') → 'Hello World'`                       |
| 5   | `Str::limit($str, $limit)`                  | 文字数を制限して「...」で省略 | `Str::limit('Hello World', 5) → 'Hello...'`                       |
| 6   | `Str::slug($str)`                           | URL用のスラッグ文字列に変換   | `Str::slug('Hello World') → 'hello-world'`                        |
| 7   | `Str::replace($search, $replace, $subject)` | 文字列を置換                  | `Str::replace('world','Laravel','Hello world') → 'Hello Laravel'` |
| 8   | `Str::contains($haystack, $needles)`        | 指定文字列が含まれるか判定    | `Str::contains('Hello Laravel', 'Laravel') → true`                |
| 9   | `Str::startsWith($haystack, $prefix)`       | 指定文字列で始まるか判定      | `Str::startsWith('Hello', 'He') → true`                           |
| 10  | `Str::endsWith($haystack, $suffix)`         | 指定文字列で終わるか判定      | `Str::endsWith('Hello', 'lo') → true`                             |

---

### 使い方
```bash
use Illuminate\Support\Str;

$name = "fukumoto mana";

// 大文字に変換
echo Str::upper($name); // FUKUMOTO MANA

// 文字数制限
echo Str::limit($name, 6); // fukumo...
```

---

## 配列操作 Arr
| メソッド                           | 説明                                         | 例                                                         |
| ---------------------------------- | -------------------------------------------- | ---------------------------------------------------------- |
| `Arr::get($array, $key, $default)` | 配列から値を取得（存在しなければデフォルト） | `Arr::get(['a' => 1], 'a') → 1`                            |
| `Arr::set(&$array, $key, $value)`  | 配列に値をセット                             | `$arr = []; Arr::set($arr, 'b.c', 5);` → `['b'=>['c'=>5]]` |
| `Arr::has($array, $key)`           | キーが存在するかチェック                     | `Arr::has(['a'=>1],'a') → true`                            |
| `Arr::forget(&$array, $keys)`      | 指定キーを削除                               | `Arr::forget($arr, 'a')`                                   |
| `Arr::pluck($array, $key)`         | 配列の中から特定キーだけ抽出                 | `Arr::pluck([['id'=>1],['id'=>2]], 'id') → [1,2]`          |

---

## コレクション collect()
➡️ 配列やデータをチェーンメソッドで操作できる便利クラス

```bash
$collection = collect([1,2,3,4]);

$filtered = $collection->filter(fn($n) => $n > 2);
// [3,4]

$sum = $collection->sum(); // 10
```

## HTTP関連 Http / Request / Response
- 外部APIリクエスト用：Http::get(), Http::post()
- テスト時は Http::fake() でモック化できる
- リクエスト取得：request()->input('name')
- レスポンス作成：response()->json(['ok'=>true])

---

# まとめ
| 分類         | クラス / ヘルパー | よく使うメソッド                        | 説明 / 例                       |
| ------------ | ----------------- | --------------------------------------- | ------------------------------- |
| 文字列       | `Str`             | `upper($str)`                           | 文字列を大文字に変換            |
| 文字列       | `Str`             | `lower($str)`                           | 文字列を小文字に変換            |
| 文字列       | `Str`             | `ucfirst($str)`                         | 先頭文字だけ大文字              |
| 文字列       | `Str`             | `limit($str, $limit)`                   | 文字数制限して省略              |
| 文字列       | `Str`             | `slug($str)`                            | URL用のスラッグ生成             |
| 配列         | `Arr`             | `get($array, $key, $default)`           | 配列から値を取得                |
| 配列         | `Arr`             | `set(&$array, $key, $value)`            | 配列に値をセット                |
| 配列         | `Arr`             | `has($array, $key)`                     | キーが存在するか                |
| 配列         | `Arr`             | `pluck($array, $key)`                   | 配列から特定キーだけ抽出        |
| 配列         | `Arr`             | `forget(&$array, $keys)`                | 配列のキーを削除                |
| コレクション | `collect()`       | `filter()`, `map()`, `sum()`, `pluck()` | 配列やDB結果をチェーンで操作    |
| 認証         | `Auth`            | `check()`, `user()`                     | ログイン状態やユーザー情報取得  |
| キャッシュ   | `Cache`           | `get()`, `put()`, `forget()`            | キャッシュ操作                  |
| ストレージ   | `Storage`         | `disk()->put()`, `get()`, `exists()`    | ファイル操作                    |
| HTTP         | `Http`            | `get()`, `post()`, `fake()`             | 外部APIアクセス、テスト用モック |
| リクエスト   | `request()`       | `input('key')`, `all()`                 | リクエストデータ取得            |
| レスポンス   | `response()`      | `json()`, `view()`                      | レスポンス作成                  |
| ログ         | `Log`             | `info()`, `error()`, `debug()`          | ログ出力                        |
