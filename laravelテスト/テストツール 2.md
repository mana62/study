# テストツール(laravel + alpine.js)

## Laravel（PHP / バックエンド）のテスト

| ツール | 用途 | 補足 |
| --- | --- | --- |
| **PHPUnit** | 単体テスト、モデル・コントローラのテスト | Laravelに標準搭載。`php artisan test` で実行可能。 |
| **Laravel Dusk** | ブラウザ操作テスト（E2Eテスト） | Chrome/Chromiumを自動操作。ログインやフォーム送信を検証。 |
| **Pest** | 単体テスト（PHPUnitベース） | シンタックスがシンプルで読みやすい。最近人気。 |

---

### ①PHPUnit

- PHPで最も標準的な単体テストフレームワーク
- Laravelには標準で組み込まれていて、`php artisan test` で簡単に実行可能

---

### ②Laravel Dusk

- ブラウザ自動操作による **E2E（End-to-End）テスト** ツール
- Chrome / Chromium を自動で操作して、画面の挙動を確認できる

#### できること

- **ログインやフォーム送信の自動操作**
- ボタンを押したり、テキストを入力したりして正しく動作するか確認
- DOMの要素や表示テキストの確認
- スクリーンショットや動画の撮影も可能

---

### ③Pest

- PHPUnitベースのテストフレームワーク
- **シンプルで読みやすい文法** が特徴
- 最近Laravelコミュニティで急速に人気

#### できること

- PHPUnitと同じ機能は全て使える（単体テスト、コントローラテスト、DBテスト）
- 文法が短くて直感的

---

## Alpine.js / フロントエンドのテスト

| ツール | 用途 | 補足 |
| --- | --- | --- |
| **Jest** | JS単体テスト | Alpine.jsの関数やユーティリティをテスト可能 |
| **Cypress** | ブラウザE2Eテスト | DOM操作やユーザー操作の検証に最適。Alpine.jsも扱える |
| **Playwright** | Cypressと同じくE2Eテスト | クロスブラウザ対応。CI環境でも実行しやすい |

---

### Cypress
- フロントの動きが複雑（Alpine.js + Vue/ReactのようなSPA寄り）の場合は、**Cypressを使うほうが便利。Laravel + Alpine.jsの場合はLaravel DuskでOK**

---

## CI/CDとの組み合わせ

- GitHub Actions / GitLab CI / CircleCI などで **push時にテストを自動実行**
- PHPUnit → 単体テスト
- Dusk / Cypress → E2Eテスト
- Jest → JSのユニットテスト

---

## 最初にphpUnitで進める→余裕があればLaravel Duskでブラウザのテストの流れ

### ① ステップ1：PHPUnitで基盤を作る

- モデル・コントローラー・APIレスポンスなどをテスト
- CI/CD（GitHub Actionsなど）でも高速に実行できる

```bash
php artisan test
```
で実行

---

### ② ステップ2：機能が安定してきたらDuskを追加

- Duskをインストールするだけで共存可能
```bash
    composer require --dev laravel/dusk
    php artisan dusk:install
```

- PHPUnitとDuskは別ディレクトリで管理される
```bash
    tests/Feature/...    ← PHPUnit
    tests/Browser/...    ← Dusk
 ```

---

### ③ ステップ3：E2EテストでUI確認を自動化
- Alpine.jsやVue.jsの動作確認もOK
- 例えば「ログイン後にダッシュボードが表示されるか」などをブラウザ操作で確認

---

### 両立できる理由

Laravelでは <br>

- PHPUnit → `tests/Feature` / `tests/Unit`
- Dusk → `tests/Browser`

と完全に別の仕組みで動いているため、影響しない <br>

---

## 参考
- [Pest Test ってどうなん？2Weekたったあとの所感](https://zenn.dev/hashi8084/articles/1b946c450d3c2c)
- [【保存版】Laravel Duskで実現する最強の自動テスト環境構築ガイド 2024年度版](https://dexall.co.jp/articles/?p=2559)
- [【Laravel Dusk】テストの生成と基本的な操作](https://qiita.com/yun-yzrh/items/3d995c83f0b58009c61f)
- [PHPUnitからPestPHPへ：テストをもっと軽快に！](https://zenn.dev/babyjob/articles/a280272f38e432)