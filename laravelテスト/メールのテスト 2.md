# ãƒ¡ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆ

## Mail ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã®åŸºæœ¬

```php
use Illuminate\Support\Facades\Mail;
use App\Mail\WelcomeMail;
```

## ãƒ†ã‚¹ãƒˆé–‹å§‹æ™‚ã« fake ã™ã‚‹

```php
Mail::fake();
```

---

## ãƒ¡ãƒ¼ãƒ«ãŒé€ä¿¡ã•ã‚ŒãŸã‹ç¢ºèª

```php
Mail::to('mana@example.com')->send(new WelcomeMail());
Mail::assertSent(WelcomeMail::class);
```

## å®›å…ˆã‚‚ç¢ºèªã—ãŸã„ã¨ã

```php
Mail::assertSent(WelcomeMail::class, function ($mail) {
    return $mail->hasTo('mana@example.com');
});
```

## Laravel 11.16ã€œ ã¯ç°¡ç•¥åŒ–ã‚‚OK

```php
Mail::assertSent(WelcomeMail::class, 'mana@example.com');
Mail::assertSent(WelcomeMail::class, ['mana@example.com']);
```

## âŒ é€ä¿¡ã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’æ¤œè¨¼

```php
Mail::assertNotSent(WelcomeMail::class);
```

---

## ãƒ¡ãƒ¼ãƒ«ãŒã‚­ãƒ¥ãƒ¼ï¼ˆéåŒæœŸï¼‰ã«å…¥ã£ãŸã‹ç¢ºèª

```php
Mail::fake();
Mail::to('mana@example.com')->queue(new WelcomeMail());

Mail::assertQueued(WelcomeMail::class);
Mail::assertQueued(WelcomeMail::class, function ($mail) {
    return $mail->hasTo('mana@example.com');
});

Mail::assertNotQueued(WelcomeMail::class);
```

---

## ä»¶åãƒ»æœ¬æ–‡ãƒ»é€ä¿¡å…ƒã‚’ãƒ†ã‚¹ãƒˆã—ãŸã„å ´åˆ

Laravelæ¨™æº–ã§ã¯**ä»¶åãƒ»æœ¬æ–‡ã®æ¤œè¨¼ã¯é›£ã—ã„**ãŒ[`spinen/laravel-mail-assertions`]ã‚’ä½¿ã†ã¨å¯èƒ½

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
composer require spinen/laravel-mail-assertions
```

### ä¾‹

```php
$this->seeEmailTo('mana@example.com');
$this->seeEmailFrom('admin@example.com');
$this->seeEmailSubjectContains('ã‚ˆã†ã“ã');
$this->seeEmailContains('ã”ç™»éŒ²ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™');
$this->seeEmailWasSent();
$this->seeEmailCountEquals(1);
```

ğŸ‘‰ ä»¶åãƒ»æœ¬æ–‡ãƒ»å®›å…ˆãƒ»é€ä¿¡å…ƒãƒ»é€ä¿¡æ•° ã¾ã§ã—ã£ã‹ã‚Šãƒã‚§ãƒƒã‚¯ã§ãã‚‹

---

## ã¾ã¨ã‚

| æ¤œè¨¼å†…å®¹                 | æ–¹æ³•                                    |
| ------------------------ | --------------------------------------- |
| ãƒ¡ãƒ¼ãƒ«ãŒé€ä¿¡ã•ã‚ŒãŸã‹     | `Mail::assertSent()`                    |
| å®›å…ˆã®ç¢ºèª               | `->hasTo()` or Laravel11ä»¥é™ã®çœç•¥è¨˜æ³•  |
| ãƒ¡ãƒ¼ãƒ«ãŒã‚­ãƒ¥ãƒ¼ã«å…¥ã£ãŸã‹ | `Mail::assertQueued()`                  |
| ä»¶åãƒ»æœ¬æ–‡ãƒ»é€ä¿¡å…ƒã®ç¢ºèª | `spinen/laravel-mail-assertions` ã‚’ä½¿ç”¨ |
| ãƒ¡ãƒ¼ãƒ«ãŒé€ã‚‰ã‚Œã¦ãªã„ã“ã¨ | `Mail::assertNotSent()`                 |

---

- `Mail::fake()` ã‚’ä½¿ã†ã“ã¨ã§ã€å®Ÿéš›ã«ã¯é€ä¿¡ã›ãšã«ã€Œé€ä¿¡ã•ã‚ŒãŸã‹ã©ã†ã‹ã€ã‚’æ¤œè¨¼ã§ãã‚‹
- å³æ™‚é…ä¿¡ãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é…ä¿¡ã©ã¡ã‚‰ã‚‚ã€`Mail::assertSent()` ã¾ãŸã¯ `Mail::assertQueued()` ã§ç¢ºèªå¯èƒ½